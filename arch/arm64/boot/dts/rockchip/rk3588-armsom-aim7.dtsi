// SPDX-License-Identifier: (GPL-2.0+ OR MIT)
/*
 * Copyright (c) 2024 Jianfeng Liu <liujianfeng1994@gmail.com>
 *
 */

#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/pinctrl/rockchip.h>
#include "rk3588.dtsi"
#include "rk3588-rk806-single.dtsi"

#include <dt-bindings/usb/pd.h>
#include <dt-bindings/pwm/pwm.h>
#include <dt-bindings/input/linux-event-codes.h>
#include <dt-bindings/display/rockchip_vop.h>
#include <dt-bindings/sensor-dev.h>
#include "rk3588-linux.dtsi"


/ {
	model = "ArmSoM AIM7 ";
	compatible = "armsom,aim7", "rockchip,rk3588";
	
		wm8904_sound: wm8904_sound {
		compatible = "simple-audio-card";
		simple-audio-card,format = "i2s";
		simple-audio-card,mclk-fs = <256>;
		simple-audio-card,name = "rockchip-wm8904";
		simple-audio-card,dai-link@0 {
			format = "i2s";
			cpu {
				sound-dai = <&i2s2_2ch>;
			};
			codec {
				sound-dai = <&codec>;
			};
		};
	};
	
	/*wm8904_sound: wm8904-sound {
		status = "okay";
		compatible = "rockchip,multicodecs-card";
		rockchip,card-name = "rockchip-wm8904";
	        io-channels = <&saradc 3>;
		io-channel-names = "adc-detect";
		keyup-threshold-microvolt = <1800000>;
		poll-interval = <100>;
		rockchip,format = "i2s";
		rockchip,mclk-fs = <256>;
		rockchip,cpu = <&i2s2_2ch>;
		rockchip,codec = <&codec>;
		rockchip,audio-routing =
			"LINPUT1", "Main Mic",
			"LINPUT2", "Main Mic";
		play-pause-key {
			label = "playpause";
			linux,code = <KEY_PLAYPAUSE>;
			press-threshold-microvolt = <2000>;
		};

		previous-song-key {
			label = "previoussong";
			linux,code = <KEY_PREVIOUSSONG>;
			press-threshold-microvolt = <145000>;
		};

		next-song-key {
			label = "nextsong";
			linux,code = <KEY_NEXTSONG>;
			press-threshold-microvolt = <290000>;
		};
		
	};*/

};

&av1d {
	status = "okay";
};

&av1d_mmu {
	status = "okay";
};

&cpu_l0 {
	cpu-supply = <&vdd_cpu_lit_s0>;
	mem-supply = <&vdd_cpu_lit_mem_s0>;
};

&cpu_b0 {
	cpu-supply = <&vdd_cpu_big0_s0>;
	mem-supply = <&vdd_cpu_big0_mem_s0>;
};

&cpu_b2 {
	cpu-supply = <&vdd_cpu_big1_s0>;
	mem-supply = <&vdd_cpu_big1_mem_s0>;
};

&gpu {
	mali-supply = <&vdd_gpu_s0>;
	mem-supply = <&vdd_gpu_mem_s0>;
	status = "okay";
};

&i2c0 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&i2c0m2_xfer>;

	vdd_cpu_big0_s0: vdd_cpu_big0_mem_s0: rk8602@42 {
		compatible = "rockchip,rk8602";
		reg = <0x42>;
		vin-supply = <&vcc5v0_sys>;
		regulator-compatible = "rk860x-reg";
		regulator-name = "vdd_cpu_big0_s0";
		regulator-min-microvolt = <550000>;
		regulator-max-microvolt = <1050000>;
		regulator-ramp-delay = <2300>;
		rockchip,suspend-voltage-selector = <1>;
		regulator-boot-on;
		regulator-always-on;

		regulator-state-mem {
			regulator-off-in-suspend;
		};
	};

	vdd_cpu_big1_s0: vdd_cpu_big1_mem_s0: rk8603@43 {
		compatible = "rockchip,rk8603";
		reg = <0x43>;
		vin-supply = <&vcc5v0_sys>;
		regulator-compatible = "rk860x-reg";
		regulator-name = "vdd_cpu_big1_s0";
		regulator-min-microvolt = <550000>;
		regulator-max-microvolt = <1050000>;
		regulator-ramp-delay = <2300>;
		rockchip,suspend-voltage-selector = <1>;
		regulator-boot-on;
		regulator-always-on;

		regulator-state-mem {
			regulator-off-in-suspend;
		};
	};
};

&i2c1 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&i2c1m2_xfer>;

	vdd_npu_s0: vdd_npu_mem_s0: rk8602@42 {
		compatible = "rockchip,rk8602";
		reg = <0x42>;
		vin-supply = <&vcc5v0_sys>;
		regulator-compatible = "rk860x-reg";
		regulator-name = "vdd_npu_s0";
		regulator-min-microvolt = <550000>;
		regulator-max-microvolt = <950000>;
		regulator-ramp-delay = <2300>;
		rockchip,suspend-voltage-selector = <1>;
		regulator-boot-on;
		regulator-always-on;

		regulator-state-mem {
			regulator-off-in-suspend;
		};
	};
};

&i2c2 {
         status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&i2c2m0_xfer>;
	

		 
		 
		    
  pca: pcal6416a@20 {
		   compatible = "nxp,pcal6416";
		     status = "okay";
		    gpio-controller;
		    #gpio-cells = <2>;
		    reg = <0x20>;
		interrupt-parent = <&gpio1>;
		 interrupts = <RK_PD5 IRQ_TYPE_LEVEL_HIGH>;
		interrupt-controller;
		 #interrupt-cells = <2>;
                  

                   
	           };
	           
	           
   pcal6524a@22 {
		   compatible = "nxp,pcal6524";
		    status = "okay";
		    gpio-controller;
		    #gpio-cells = <2>;
		    reg = <0x22>;
		interrupt-parent = <&gpio3>;
		 interrupts = <RK_PA7 IRQ_TYPE_LEVEL_HIGH>;
		interrupt-controller;
		 #interrupt-cells = <2>;
                    
	          };    
		    
		    
		    

};

&i2c4 {
        status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&i2c4m2_xfer>;
	
	
 tca8418@34 {
                  compatible = "ti,tca8418";
                  interrupt-parent = <&gpio3>;
		 interrupts = <RK_PC4 IRQ_TYPE_LEVEL_HIGH>;
                   reg = <0x34>;
                   keypad,num-rows = <3>;
                   keypad,num-columns = <2>;
                   linux,keymap = <
                        0x0000003b
                        0x0001003c
                        0x0100003d
                        0x0101003e
                        0x0200003f
                        0x02010040
                      >;
                       status = "okay";
		    };
		    
	  	 
	
	  pca2: pcal6416@20 {
		   compatible = "nxp,pcal6416";
		     status = "okay";
		    gpio-controller;
		    #gpio-cells = <2>;
		    reg = <0x20>;
		interrupt-parent = <&gpio0>;
		 interrupts = <RK_PA4 IRQ_TYPE_LEVEL_HIGH>;
		interrupt-controller;
		 #interrupt-cells = <2>;
                  

                   
	           };
	

};
&i2c6 {
        status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&i2c6m1_xfer>;
	
	
	 gt9xx_dsi1: gt911@5d {
	    status = "okay";
            compatible = "goodix,gt911";
            reg = <0x5d>;
            interrupt-parent = <&gpio3>;
	    interrupts = <RK_PA1 IRQ_TYPE_LEVEL_LOW>;
            reset-gpios = <&gpio4 RK_PA4  GPIO_ACTIVE_LOW>;
            irq-gpios = <&gpio3 RK_PA1  GPIO_ACTIVE_HIGH>;
            touchscreen-inverted-x = <1>;
	    touchscreen-inverted-y = <1>;
                };		
	
	  codec: wm8904@1a { 
               status = "okay";
		#sound-dai-cells = <0>;
		compatible = "wlf,wm8904";
		reg = <0x1a>;
		clocks = <&mclkout_i2s2>;
		clock-names = "mclk";
		assigned-clocks = <&mclkout_i2s2>;
		assigned-clock-rates = <12288000>;
		pinctrl-names = "default";
		pinctrl-0 = <&i2s2m1_mclk>;
		DBVDD-supply = <&vcc_1v8_s0>;
                DCVDD-supply = <&vcc_1v8_s0>;
                AVDD-supply = <&vcc_1v8_s0>;
                CPVDD-supply = <&vcc_1v8_s0>;
                MICVDD-supply = <&vcc_3v3_s3>;
		
		
                       };
                                         
	
};



&i2s2_2ch {
	status = "okay";
	rockchip,clk-trcm = <1>;
	pinctrl-names = "default";
	pinctrl-0 = <&i2s2m1_sdi
			     &i2s2m1_sdo>;
		pinctrl-2 = <&i2s2m1_lrck
			     &i2s2m1_sclk>;

			 
			 
};



&iep {
	status = "okay";
};

&iep_mmu {
	status = "okay";
};

&jpegd {
	status = "okay";
};

&jpegd_mmu {
	status = "okay";
};

&jpege_ccu {
	status = "okay";
};

&jpege0 {
	status = "okay";
};

&jpege0_mmu {
	status = "okay";
};

&jpege1 {
	status = "okay";
};

&jpege1_mmu {
	status = "okay";
};

&jpege2 {
	status = "okay";
};

&jpege2_mmu {
	status = "okay";
};

&jpege3 {
	status = "okay";
};

&jpege3_mmu {
	status = "okay";
};

&mpp_srv {
	status = "okay";
};

&rga3_core0 {
	status = "okay";
};

&rga3_0_mmu {
	status = "okay";
};

&rga3_core1 {
	status = "okay";
};

&rga3_1_mmu {
	status = "okay";
};

&rga2 {
	status = "okay";
};

&rknpu {
	rknpu-supply = <&vdd_npu_s0>;
	mem-supply = <&vdd_npu_mem_s0>;
	status = "okay";
};

&rknpu_mmu {
	status = "okay";
};

&rkvdec_ccu {
	status = "okay";
};

&rkvdec0 {
	status = "okay";
};

&rkvdec0_mmu {
	status = "okay";
};

&rkvdec1 {
	status = "okay";
};

&rkvdec1_mmu {
	status = "okay";
};

&rkvenc_ccu {
	status = "okay";
};

&rkvenc0 {
	status = "okay";
};

&rkvenc0_mmu {
	status = "okay";
};

&rkvenc1 {
	status = "okay";
};

&rkvenc1_mmu {
	status = "okay";
};

&rockchip_suspend {
	status = "okay";
	rockchip,sleep-debug-en = <1>;
};

&saradc {
	status = "okay";
	vref-supply = <&vcc_1v8_s0>;
};

&sdhci {
	bus-width = <8>;
	no-sdio;
	no-sd;
	non-removable;
	max-frequency = <200000000>;
	mmc-hs400-1_8v;
	mmc-hs400-enhanced-strobe;
	full-pwr-cycle-in-suspend;
	status = "okay";
};

&tsadc {
	status = "okay";
};

&vdpu {
	status = "okay";
};

&vdpu_mmu {
	status = "okay";
};

&vepu {
	status = "okay";
};




